<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]--><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="Asciidoctor 1.5.6.1"><title>Nelson Tan - Project Portfolio</title><link rel="stylesheet" href="../stylesheets/gh-pages.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
<link rel="stylesheet" href="../stylesheets/coderay-asciidoctor.css"></head><body class="article"><div id="site-header"><nav class="navbar navbar-light bg-light"><div class="container"><a class="navbar-brand" href="../index.html">Coupon Stash</a><ul class="navbar-nav"><li class="nav-item"><a class="nav-link" href="../UserGuide.html">User Guide</a></li><li class="nav-item"><a class="nav-link" href="../DeveloperGuide.html">Developer Guide</a></li><li class="nav-item"><a class="nav-link active" href="../AboutUs.html">About Us</a></li><li class="nav-item"><a class="nav-link" href="../ContactUs.html">Contact Us</a></li><li class="navitem"><a class="nav-link" href="https://github.com/AY1920S2-CS2103T-F09-1/main"><span class="fa fa-github fa-lg" aria-hidden="true"></span>&nbsp;View on GitHub</a></li></ul></div></nav></div><div id="header"><h1>Nelson Tan - Project Portfolio</h1></div><div id="content"><div class="sect1">
<h2 id="project-coupon-stash"><a class="link" href="#project-coupon-stash">PROJECT: Coupon Stash</a></h2>
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="../images/Ui.png" alt="Ui" width="600">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview"><a class="link" href="#overview">Overview</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Coupon Stash is a desktop coupons manager that allows users to keep track of
their coupons. The user interacts with it using a CLI, and it has a beautiful
GUI created with JavaFX. It is written in Java, and has about 15kLoC.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="summary-of-contributions"><a class="link" href="#summary-of-contributions">Summary of contributions</a></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><strong>Major enhancement</strong>: added <strong>the ability to undo and redo operations</strong> (Pull
request
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/91">#91</a>,
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/135">#135</a>,
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/284">#284</a>)</p>
<div class="ulist">
<ul>
<li>
<p>What it does: allows the user to undo the most recent operation on the
coupon stash. Undoing can itself be undone via the redo operation.</p>
</li>
<li>
<p>Justification: This feature is essential in allowing users who&#8217;ve made
mistakes in their operations on the coupon stash to revert their changes.
Addtionally, users will also want to be able to revert to their reverted
changes, and this led to the creation of the undo and redo commands.</p>
</li>
<li>
<p>Highlights: This enhancement required the deep copy of all a coupon&#8217;s
fields so as to prevent unpredictable side effects down the line. Thus,
there was constant collaboration and communication with the group members
regarding how to best tie in this feature with the rest of the features.
Some new commands added by other group members also require updates to
be pushed to the undo and redo feature, thus this was a very dynamic
feature that needed frequent updates.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Major enhancement</strong>: added <strong>the ability to share coupons as images</strong> (Pull
request
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/176">#176</a>,
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/384">#384</a>)</p>
<div class="ulist">
<ul>
<li>
<p>What it does: allows the user to share their coupons as an image file.</p>
</li>
<li>
<p>Justification: In the 21st century where everyone seems to post every
thing on social media, the ability for users to share their coupons as a
format ripe for social media consumption is of upmost importance. This
feature allows users to share their coupons in a portable format for sharing
over various platforms.</p>
</li>
<li>
<p>Highlights: This enhancement required the rendering of a <code>CouponCard</code> in a
<code>Scene</code>, before we proceed to take a <code>snapshot</code> of the <code>CouponCard</code>. The main
challenge came when trying to save the <code>WritableImage</code> returned by <code>snapshot</code>
as a <code>.png</code> file. To perform that task, an external module
(<code>javax.imageio.ImageIO</code>) had to be requested to be used. Then, the image
needed a save dialog to be saved. Due to file operations having potential for
many errors, exceptions has to be caught and thrown and multiple error
messages were also created to best reflect an error.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Major enhancement</strong>: added <strong>the ability to open an offline copy of the user
guide</strong> (Pull
request
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/201">#201</a>,
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/284">#284</a>,
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/385">#385</a>)</p>
<div class="ulist">
<ul>
<li>
<p>What it does: allows the user to open an offline copy of the user guide in
their web browser with the <code>help</code> command.</p>
</li>
<li>
<p>Justification: While the help tab exists, the help tab only shows
information about the commands. Much more of the program&#8217;s functionality is
available in the user guide, and with the program being an offline
application, it is thus very useful for the user to be able to read the user
guide offline. This will empower users to fully exploit the potential of our
program.</p>
</li>
<li>
<p>Highlights: The user guide is stored as a single <code>.html</code> file with
all styles and images embed into that single ~6 MB file.
The file has to be packaged into the release jar file,
before it gets extracted from the jar file on the first time the <code>help</code>
command is executed. It was a challenge to reliably get the path of the jar
file. (We need the path to extract the <code>.html</code> from the jar) After figuring
out how to get the jar file path during runtime, we had to extract the
<code>.html</code> file from within the jar file and then write it to the directory the
jar file resides. Initially, writing to a file was very slow and it would
even make the program crash sometimes! Then, I remembered what I learnt from
CS2106 and realised that a buffered writing operation will reduce system
calls and thus be faster. And lo and behold, after the implementation of a
write buffer, writing speeds got a lot faster. (now it only takes one second)</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Minor enhancement</strong>: added a history command that allows the user to navigate
to previous commands using up/down keys. (Pull
request
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/135">#135</a>,
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/140">#140</a>)</p>
</li>
<li>
<p><strong>Minor enhancement</strong>: added a sort command that allows the user to sort
coupons by the names, expiry dates, and remind dates in ascending order. (Pull
request
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/140">#140</a>,
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/284">#284</a>)</p>
</li>
<li>
<p><strong>Minor enhancement</strong>: worked on the expand command. (Pull request
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/375">#375</a>)</p>
</li>
<li>
<p><strong>Minor enhancement</strong>: wrote the logic for the Help Pane. (Pull request
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/215">#215</a>)</p>
</li>
<li>
<p><strong>Minor enhancement</strong>: improved and cleaned up the remind command. (Pull request
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/329">#329</a>)</p>
</li>
<li>
<p><strong>Code contributed</strong>: [<a href="https://nus-cs2103-ay1920s2.github.io/tp-dashboard/#=undefined&amp;search=nelsontky">All contributed code</a>]</p>
</li>
<li>
<p><strong>Other contributions</strong>:</p>
<div class="ulist">
<ul>
<li>
<p>Project management:</p>
<div class="ulist">
<ul>
<li>
<p>Managed releases <code>v1.3</code> - <code>v1.5rc</code> (3 releases) on GitHub</p>
</li>
</ul>
</div>
</li>
<li>
<p>Enhancements to existing features:</p>
<div class="ulist">
<ul>
<li>
<p>Updated the help menu <a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/215">#215</a></p>
</li>
<li>
<p>Updated the help command to open an offline copy of the user guide
<a href="https://github.com/AY1920S2-CS2103T-F09-1/main/pull/284">#284</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>Community:</p>
<div class="ulist">
<ul>
<li>
<p>Contributed to forum discussions
(example:  <a href="https://github.com/nus-cs2103-AY1920S2/forum/issues/7">1</a>)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributions-to-the-user-guide"><a class="link" href="#contributions-to-the-user-guide">Contributions to the User Guide</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Here are some sections of the User Guide authored by me.</p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="sorting-coupons-code-sort-code"><a class="link" href="#sorting-coupons-code-sort-code">Sorting coupons: <code>sort</code></a></h3>
<div class="paragraph">
<p>Sorts the coupons in Coupon Stash in <strong>ascending</strong> order. It is possible to sort
by coupon name, expiry date, or remind date.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
When you <a href="#Editing a coupon: <code>edit</code>"><code>edit</code></a> or
<a href="#Adding a coupon: <code>add</code>"><code>add</code></a> a coupon, the sorting order will revert to
the original order. Otherwise, the sorting order will persist throughout the
runtime of the  program.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The command will sort any coupons currently on screen, including
<a href="#archive">archived</a> coupons, if they are present on
screen. <a href="#archive">Archived</a> coupons will always appear
<strong>below</strong> active coupons.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Format: <code>sort PREFIX</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>The <code>PREFIX</code> can be either <code>n/</code>, <code>e/</code> or <code>r/</code>.</p>
</li>
<li>
<p>Using <code>n/</code> would mean sorting by name, <code>e/</code> would mean sorting by
expiry date, and <code>r/</code> would mean sorting by reminder date.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>sort n/</code><br>
Sorts the Coupon Stash by name in ascending order.</p>
</li>
<li>
<p><code>sort e/</code><br>
Sorts the Coupon Stash by expiry date from earliest to latest.</p>
</li>
<li>
<p><code>sort r/</code><br>
Sorts the Coupon Stash by reminder date from earliest to latest.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="undoing-the-previous-command-code-undo-code"><a class="link" href="#undoing-the-previous-command-code-undo-code">Undoing the previous command: <code>undo</code></a></h3>
<div class="paragraph">
<p>Undo the most recent operation on the Coupon Stash. Only operations that change
the coupons in the Coupon Stash can be undone.</p>
</div>
<div class="paragraph">
<p>Format: <code>undo</code></p>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p>Undo only works on the following commands: (i.e. commands that change the
coupons in the Coupon Stash)<br></p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#Adding a coupon: <code>add</code>"><code>add</code></a></p>
</li>
<li>
<p><a href="#Editing a coupon: <code>edit</code>"><code>edit</code></a></p>
</li>
<li>
<p><a href="#Deleting a coupon: <code>delete</code>"><code>delete</code></a></p>
</li>
<li>
<p><a href="#Archiving a coupon: <code>archive</code>"><code>archive</code></a></p>
</li>
<li>
<p><a href="#Unarchiving a coupon: <code>unarchive</code>"><code>unarchive</code></a></p>
</li>
<li>
<p><a href="#Clearing all entries: <code>clear</code>"><code>clear</code></a></p>
</li>
<li>
<p><a href="#Using a coupon: <code>used</code>"><code>used</code></a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Changes to user preferences, such as the
<a href="#setcurrency">setting of the currency symbol</a>, cannot be undone.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
You can only undo commands which you have input since
you opened Coupon Stash. This means that after you close
the application, your undo history will be lost!
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>edit 1 r/ 25-12-2020</code><br>
<code>undo</code><br>
Undo the <a href="#Editing a coupon: <code>edit</code>"><code>edit</code></a> command. Remind date of first coupon in the coupon list reverts back to its
previous value.</p>
</li>
<li>
<p><code>delete 1</code><br>
<code>undo</code><br>
Revert the <a href="#Deleting a coupon: <code>delete</code>"><code>delete</code></a> that was performed. Deleted coupon is restored.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="redoing-the-undone-command-code-redo-code"><a class="link" href="#redoing-the-undone-command-code-redo-code">Redoing the undone command: <code>redo</code></a></h3>
<div class="paragraph">
<p>Redo the previously undone operation. This is akin to undoing an
<a href="#undoing-the-previous-command-code-undo-code"><code>undo</code></a>.</p>
</div>
<div class="paragraph">
<p>Format: <code>redo</code></p>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>edit 1 r/ 25-12-2020</code><br>
<code>undo</code><br>
<code>redo</code><br>
Un-undo the <a href="#Editing a coupon: <code>edit</code>"><code>edit</code></a> command. Remind date of first coupon that was in the resulting coupon
list is edited.</p>
</li>
<li>
<p><code>delete 1</code><br>
<code>undo</code><br>
<code>redo</code><br></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Un-undo the <a href="#Deleting a coupon: <code>delete</code>"><code>delete</code></a> command. First coupon that
was in the resulting coupon list is deleted.</p>
</div>
</div>
<div class="sect2">
<h3 id="expanding-a-coupon-code-expand-code"><a class="link" href="#expanding-a-coupon-code-expand-code">Expanding a coupon: <code>expand</code></a></h3>
<div class="paragraph">
<p>Displays a coupon in its own window, giving you a
complete expanded view of it.</p>
</div>
<div class="paragraph">
<p>Format: <code>expand INDEX</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>Expands the coupon at the specified <a href="#index">INDEX</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>expand 1</code><br>
Opens the first coupon in the coupon list in a new window.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/expand_example.png" alt="expand example">
</div>
<div class="title">Figure 1. Example of an expanded coupon window.</div>
</div>
</div>
<div class="sect2">
<h3 id="reminding-of-coupon-expiry"><a class="link" href="#reminding-of-coupon-expiry">Reminding of coupon expiry</a></h3>
<div class="paragraph">
<p>By default, all added coupons have a remind date that is 3 days before its
stated expiry date. This default value can be changed during the process of
<a href="#_adding_a_coupon_add">adding</a> a new coupon or by
<a href="#_editing_a_coupon_edit">editing</a> an existing coupon. The remind dates for all
coupons are checked on program launch. All coupons that have a remind date which
falls on the date of program launch will be listed in a popup window on launch.
The popup window can be closed by pressing <kbd>Ctrl</kbd> + <kbd>q</kbd>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/ug_reminder_window.PNG" alt="ug reminder window">
</div>
<div class="title">Figure 2. Popup window showing all coupons that have their remind dates set on the date of program launch.</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Remind dates are <strong>only</strong> checked during program launch. Thus, if a day passes
while the program is open, even if there are coupons expiring on the new day,
no new reminder window will open.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As of now, there is no
functionality for the disabling of reminders for coupons. This feature will be
made available in version 2.0.</p>
</div>
<div class="exampleblock">
<div class="content">
<div class="ulist">
<ul>
<li>
<p>The format of dates entered via the <code>r/</code> field is
in the D-M-YYYY format. (<a href="#coupon-stash-date-format">Coupon Stash date format</a>)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="paragraph">
<p>Examples:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>add n/McDonald&#8217;s McGriddles p/ILOVEMCGRIDDLES e/31-12-2020 s/$2
sd/1-4-2020 l/2 t/value t/savoury</code></p>
<div class="paragraph">
<p>Add a new Coupon without specifying a remind date. Note that the default
remind date is 3 days before the state expiry date:</p>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/ug_mcdonalds_mcgriddles.png" alt="ug mcdonalds mcgriddles">
</div>
<div class="title">Figure 3. New coupon with a default remind date.</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>add n/Grabfood s/40% e/30-4-2020 p/GRAB40 t/delivery r/10-4-2020</code></p>
<div class="paragraph">
<p>Add a new Coupon while specifying a remind date of <code>10-04-2020</code>:</p>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/ug_Grabfood_reminder.png" alt="ug Grabfood reminder">
</div>
<div class="title">Figure 4. New coupon with remind date set to <code>10-04-2020</code>.</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>edit 1 r/10-4-2020</code></p>
<div class="paragraph">
<p>Edit the coupon at index 1 and change its remind date to <code>10-4-2020</code>.</p>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="KeyboardShortcuts"><a class="link" href="#KeyboardShortcuts">Keyboard Shortcuts</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>With Coupon Stash being optimized for efficient command line usage, how can we
not include some nifty keyboard shortcuts to further streamline
your workflow! This section introduces some of the keyboard shortcuts available
for use in this program.</p>
</div>
<div class="sect2">
<h3 id="restore-previously-entered-command-texts-kbd-kbd-and-kbd-kbd"><a class="link" href="#restore-previously-entered-command-texts-kbd-kbd-and-kbd-kbd">Restore previously entered command texts: <kbd>↑</kbd> and <kbd>↓</kbd></a></h3>
<div class="paragraph">
<p>Pressing the <kbd>↑</kbd> keyboard button while the focus is on the command box
allows you to restore the text of the previous executed command. Pressing
the <kbd>↓</kbd> keyboard button allows you to revert to a more recently entered
command.</p>
</div>
<div class="paragraph">
<p>Demonstration:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/gifs/Up%20down%20arrow.gif" alt="Up down arrow">
</div>
<div class="title">Figure 5. Animation of <kbd>↑</kbd>/<kbd>↓</kbd> button presses.</div>
</div>
</div>
<div class="sect2">
<h3 id="close-expanded-coupon-or-reminder-windows-kbd-ctrl-kbd-kbd-q-kbd"><a class="link" href="#close-expanded-coupon-or-reminder-windows-kbd-ctrl-kbd-kbd-q-kbd">Close expanded coupon or reminder windows: <kbd>Ctrl</kbd>+<kbd>q</kbd></a></h3>
<div class="paragraph">
<p>After <a href="#expanding-a-coupon-code-expand-code"><code>expanding</code></a> a coupon, you can close
the expanded coupon window by keeping the focus on the coupon window and
pressing the keyboard buttons <kbd>Ctrl</kbd> and <kbd>q</kbd> simultaneously. This
shortcut also works for closing <a href="#_reminding_of_coupon_expiry">reminder</a>
windows.</p>
</div>
<div class="paragraph">
<p>Demonstration:
during the process of adding
.Animation of closing window with <kbd>Ctrl</kbd>+<kbd>q</kbd>.
image::gifs/ctrl q.gif[]</p>
</div>
</div>
<div class="sect2">
<h3 id="cycle-through-tabs-kbd-ctrl-kbd-kbd-tab-kbd"><a class="link" href="#cycle-through-tabs-kbd-ctrl-kbd-kbd-tab-kbd">Cycle through tabs: <kbd>Ctrl</kbd>+<kbd>Tab</kbd></a></h3>
<div class="paragraph">
<p>You can press the keyboard buttons <kbd>Ctrl</kbd> and <kbd>Tab</kbd> simultaneously to
switch tabs. Do note that the focus has to be on the main panel before the
key presses would work.</p>
</div>
<div class="paragraph">
<p>Demonstration:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/gifs/ctrl%20tab.gif" alt="ctrl tab">
</div>
<div class="title">Figure 6. Animation of switching tabs with <kbd>Ctrl</kbd>+<kbd>Tab</kbd>.</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributions-to-the-developer-guide"><a class="link" href="#contributions-to-the-developer-guide">Contributions to the Developer Guide</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>These are some sections I contributed to the Developer Guide.
Highlights include frequent use of Unified Modelling Language
(UML) diagrams to illustrate associations between program components.</em></p></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="undo-redo-feature"><a class="link" href="#undo-redo-feature">Undo/Redo feature</a></h3>
<div class="paragraph">
<p>The undo/redo mechanism is facilitated by with an undo/redo history, stored
internally as an <code>couponStashStateList</code> with a <code>commandTextHistory</code> and
<code>currStateIndex</code>. All these components are encapsulated in the <code>HistoryManager</code>
class.
The following methods in the <code>Model</code> interface facilitates this feature:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Model#commitCouponStash(String commandText)</code>&#8201;&#8212;&#8201;Saves the current coupon
stash state and the command text that triggered the change in state into
<code>HistoryManager</code>.</p>
</li>
<li>
<p><code>Model#undo()</code>&#8201;&#8212;&#8201;Restores the previous coupon stash state from
<code>HistoryManager</code>.</p>
</li>
<li>
<p><code>Model#redo()</code>&#8201;&#8212;&#8201;Restores a previously undone coupon stash state from
<code>HistoryManager</code>.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="current-implementation"><a class="link" href="#current-implementation">Current Implementation</a></h4>
<div class="paragraph">
<p>Given below is an example usage scenario and how the undo/redo mechanism
behaves at each step.</p>
</div>
<div class="paragraph">
<p>Step 1. The user launches the application for the first time.
The <code>CouponStash</code> will be initialized with the initial coupon stash state, and
the <code>currStateIndex</code> pointing to that single coupon stash state.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UndoRedoState0.png" alt="UndoRedoState0" width="400">
</div>
<div class="title">Figure 7. <code>CouponStash</code> will be initialized with the initial coupon stash state.</div>
</div>
<div class="paragraph">
<p>Step 2. The user executes <code>delete 5</code> command to delete the 5th coupon in the
coupon stash.
The <code>delete</code> command calls <code>Model#commitCouponStash(String commandText)</code>,
causing the modified state of the coupon stash after the <code>delete 5</code> command
executes to be saved in the <code>couponStashStateList</code>, and the <code>delete 5</code> command
text to be stored in the <code>commandTextHistory</code>.  <code>currStateIndex</code> is shifted to
the newly inserted coupon stash state.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UndoRedoState1.png" alt="UndoRedoState1" width="400">
</div>
<div class="title">Figure 8. <code>currStateIndex</code> is shifted to the newly inserted coupon stash state.</div>
</div>
<div class="paragraph">
<p>Step 3. The user executes <code>add n/OMO STORE &#8230;&#8203;</code> to add a new coupon.
The <code>add</code> command also calls <code>Model#commitCouponStash(String commandText)</code>,
causing another modified coupon stash state and command text to be saved into
the <code>couponStashStateList</code> and <code>commandTextHistory</code> respectively.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UndoRedoState2.png" alt="UndoRedoState2" width="400">
</div>
<div class="title">Figure 9. Modified coupon stash state and command text are saved into the <code>couponStashStateList</code> and <code>commandTextHistory</code> respectively.</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If a command fails its execution, it will not call
<code>Model#commitCouponStash(String commandText)</code>, so the coupon stash state and
command text will not be saved.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Step 4. The user now decides that adding the coupon was a mistake, and decides
to undo that action by executing the <code>undo</code> command.
The <code>undo</code> command will call <code>Model#undoCouponStash()</code>, which will shift the
<code>currStateIndex</code> once to the left, pointing it to the previous coupon stash
state, and restores the coupon stash to that state. Plus, the command text is
returned, thus allowing for the display of the command that was undone. In this
case, the command undone is <code>add n/OMO STORE&#8230;&#8203;</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UndoRedoState3.png" alt="UndoRedoState3" width="400">
</div>
<div class="title">Figure 10. <code>currStateIndex</code> shifted once to the left.</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the <code>currStateIndex</code> is at index 0, pointing to the initial coupon stash
state, then there are no previous coupon stash states to restore.
The <code>undo</code> command uses <code>Model#canUndoCouponStash()</code> to check if this is the
case.
If so, it will return an error to the user rather than attempting to perform
the undo.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following sequence diagram shows how the undo operation works:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UndoSequenceDiagram.png" alt="UndoSequenceDiagram">
</div>
<div class="title">Figure 11. Undo operation sequence diagram.</div>
</div>
<div class="paragraph">
<p>The <code>redo</code> command does the opposite&#8201;&#8212;&#8201;it calls <code>Model#redoCouponStash()</code>,
which shifts the <code>currStateIndex</code> once to the right, pointing to the previously
undone state and command text, and restores the coupon stash to that state.
Finally, it returns the redone command text.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the <code>currStateIndex</code> is at index <code>couponStashStateList.size() - 1</code>, pointing
to the latest coupon stash state, then there are no undone coupon stash states
to restore.
The <code>redo</code> command uses <code>Model#canRedoCouponStash()</code> to check if this is the
case.
If so, it will return an error to the user rather than attempting to perform
the redo.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Step 5. The user then decides to execute the command <code>list</code>.
Commands that do not modify the coupon stash, such as <code>list</code>, will  not call
<code>Model#commitCouponStash()</code>.
Thus, the <code>couponStashStateList</code> remains unchanged.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UndoRedoState4.png" alt="UndoRedoState4" width="400">
</div>
<div class="title">Figure 12. <code>couponStashStateList</code> remains unchanged.</div>
</div>
<div class="paragraph">
<p>Step 6. The user executes <code>clear</code>, which calls <code>Model#commitCouponStash()</code>.
Since the <code>currStateIndex</code> is not pointing at the end of the
<code>couponStashStateList</code>, all coupon stash states and command text history after
the <code>currStateIndex</code> will be purged.
We designed it this way because it no longer makes sense to redo the <code>add n/OMO
                                                                      STORE &#8230;&#8203;</code> command.
This is the behavior that most modern desktop applications follow.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UndoRedoState5.png" alt="UndoRedoState5" width="400">
</div>
<div class="title">Figure 13. Command text history after the <code>currStateIndex</code> is purged.</div>
</div>
<div class="paragraph">
<p>The following activity diagram summarizes what happens when a user executes a
new command text:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/CommitActivityDiagram.png" alt="CommitActivityDiagram">
</div>
<div class="title">Figure 14. Activity diagram representation of how command texts are saved when they are executed.</div>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations"><a class="link" href="#design-considerations">Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-how-undo-redo-executes"><a class="link" href="#aspect-how-undo-redo-executes">Aspect: How undo &amp; redo executes</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice):</strong> Saves the entire coupon stash.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Easy to implement.</p>
</li>
<li>
<p>Cons: May have performance issues in terms of memory usage. Plus, have to
perform deep copy of coupons when saving the coupon stash so as to prevent
unwanted mutations.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2:</strong> Individual command knows how to undo/redo by itself.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Will use less memory (e.g. for <code>delete</code>, just save the coupon being
deleted).</p>
</li>
<li>
<p>Cons: We must ensure that the implementation of each individual command is
correct.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Alternative 1 was chosen due to its relative simplicity and extensibility.
Little to no modification needs to be made to each command that can be
undone, thus reducing chances of new bugs surfacing. Additionally, the ability
to undo operations such as <code>clear</code> will require alternative 2 to copy the
entire coupon stash too, so both alternatives will have the same memory
footprint in such a context. Finally, the real world performance impact of
copying all coupons vs copying one is not very huge. Thus, the more
extensible and simpler alternative 1 was chosen.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="up-down-arrow-retrieve-command-history"><a class="link" href="#up-down-arrow-retrieve-command-history">Up/down arrow retrieve command history</a></h3>
<div class="sect3">
<h4 id="current-implementation-2"><a class="link" href="#current-implementation-2">Current Implementation</a></h4>
<div class="paragraph">
<p>The retrieving of command history via the up and down arrow keys is facilitated
by the <code>CommandTextHistory</code> class. The command history is stored internally as
a <code>LinkedList</code> used as a stack with a <code>currIndex</code>
tracking the next command in the history to return.
The following methods and attributes in the <code>CommandTextHistory</code>
class facilitates this feature:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CommandTextHistory#add(String commandText)</code></p>
</li>
<li>
<p><code>CommandTextHistory#getDown()</code></p>
</li>
<li>
<p><code>CommandTextHistory#getUp()</code></p>
</li>
<li>
<p><code>CommandTextHistory#commandTextHistory</code></p>
</li>
<li>
<p><code>CommandTextHistory#currIndex</code></p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UpDownClassDiagram.png" alt="UpDownClassDiagram">
</div>
<div class="title">Figure 15. Class diagram representation of the command history retrieving function.</div>
</div>
<div class="paragraph">
<p>Given below is an example usage scenario and how the up/down button presses
behaves at each step.</p>
</div>
<div class="paragraph">
<p>Step 1. The user launches the application for the first time. The
<code>CommandTextHistory</code> is initialized
with a stack containing only an empty string (<code>""</code>), and the <code>currIndex</code>
is set to <code>0</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UpDownHistory0.png" alt="UpDownHistory0">
</div>
<div class="title">Figure 16. Stack containing only an empty string</div>
</div>
<div class="paragraph">
<p>Step 2. The user executes <code>delete 1</code>. <code>CommandBox#handleCommandEntered()</code> will
call <code>CommandTextHistory#add(String commandText)</code> to save the entered command
into
the stack contained in <code>CommandTextHistory</code>. The top of the stack (i.e. the
empty string) is popped off first, before
the entered command is pushed onto the stack. Then, the empty string is pushed
onto the stack again, thus ensuring that
the empty string stays at the top of the stack. Note that <code>currIndex</code> is not
affected.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UpDownHistory1.png" alt="UpDownHistory1">
</div>
<div class="title">Figure 17. Stack after executing <code>delete 1</code></div>
</div>
<div class="paragraph">
<p>Step 3. The user executes <code>delete 2</code>. <code>CommandBox#handleCommandEntered()</code> will
also save the entered command into
the stack contained in <code>CommandTextHistory</code>. As in the previous step, the new
command is pushed to the top of the stack,
just below the empty string.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UpDownHistory2.png" alt="UpDownHistory2">
</div>
<div class="title">Figure 18. Stack after executing <code>delete 2</code>.</div>
</div>
<div class="paragraph">
<p>Step 3. Now, the user decides to delete the second coupon again. We press the
arrow key up once,
and <code>CommandBox#commandTextField</code> has a listener that calls
<code>CommandTextHistory#getUp()</code>.
The <code>currIndex</code> is incremented, and then the command text pointed to by
<code>currIndex</code> is returned and
displayed in the program command box.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UpDownHistory3.png" alt="UpDownHistory3">
</div>
<div class="title">Figure 19. After pressing the "up" arrow key.</div>
</div>
<div class="paragraph">
<p>Step 4. The user then executes the retrieved command (<code>delete 2</code>). As in the
previous steps, this newly executed command
is pushed to the top of the stack just below the empty string. However, in such
a case when the <code>currIndex</code> is not <code>0</code> and
does not point to the top of the stack, it is reset to <code>0</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UpDownHistory4.png" alt="UpDownHistory4">
</div>
<div class="title">Figure 20. Stack after executing <code>delete 2</code> again.</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the <code>currStateIndex</code> is pointing to the top of the stack,
then there are no previous commands to retrieve. Thus, the up button will simply
return the empty string. No changes to the stack and <code>currIndex</code> will be
effected.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The down arrow key does the opposite, it will lead to the calling of
<code>CommandTextHistory#getDown()</code>,
which shifts the <code>currIndex</code> one item higher (i.e. decrement the <code>currIndex</code> by
<code>1</code>), before returning
the command text pointed by the updated <code>currIndex</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If the <code>currIndex</code> is at index <code>commandTextHistory.size() - 1</code>, pointing to the
bottom of the stack, there is no next command to retrieve when pressing the
down key. Thus,
the down button will simple return the command text currently being pointed to
by the <code>currIndex</code>.
No changes to the stack and <code>currIndex</code> will be affected.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Below is a sequence diagram describing the events that happen when a user
presses a key.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UpDownSequenceDiagram.png" alt="UpDownSequenceDiagram">
</div>
<div class="title">Figure 21. Sequence diagram representing retrieval of command text history with the up and down arrow keys.</div>
</div>
<div class="paragraph">
<p>Below is a sequence diagram describing the events that happen when a executes
a command text, thus triggering the saving of a command text into
<code>CommandTextHistory</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/UpDownSequenceDiagramAdd.png" alt="UpDownSequenceDiagramAdd">
</div>
<div class="title">Figure 22. Sequence diagram representing the saving of a command text.</div>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-2"><a class="link" href="#design-considerations-2">Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-data-structure-to-support-the-key-actions"><a class="link" href="#aspect-data-structure-to-support-the-key-actions">Aspect: Data structure to support the key actions</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice):</strong> Use <code>LinkedList</code> as a stack to store
the command text history.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: <code>LinkedList</code> is a better data structure that allows for more efficient
operations supported by stacks.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2:</strong> Use <code>ArrayList</code> as a stack to store
the command text history.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: <code>ArrayList</code> is more recognizable to people who are relatively new to
Java, thus reducing confusion.</p>
</li>
<li>
<p>Cons: Stack operations are less efficient on <code>ArrayList</code> s.
=== Coupon Sorting
==== Current implementation
The sorting of coupons in the coupon stash is facilitated by the following
static variables in the <code>SortCommand</code> class and this methods in the <code>Model</code>
interface and <code>SortedList</code> class.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>SortCommand#NAME_COMPARATOR</code> - Comparator that sorts coupons by name in
ascending order.</p>
</li>
<li>
<p><code>SortCommand#EXPIRY_COMPARATOR</code> - Comparator that sorts coupons by expiry
date in ascending order.</p>
</li>
<li>
<p><code>SortCommand#REMINDER_COMPARATOR</code> - Comparator that sorts coupons by
remind date in ascending order.</p>
</li>
<li>
<p><code>Model#sortCoupons(Comparator&lt;Coupon&gt; comparator)</code> - Sorts the
<code>ObservableList</code> of coupons that are stored in <code>Model</code> according to the
order decided by the passed in <code>comparator</code>.</p>
</li>
<li>
<p><code>SortedList#setComparator(Comparator&lt;Coupon&gt; comparator)</code> - Sets the
comparator that determines the order of the coupons inside the sorted list.</p>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/SortingClassDiagram.png" alt="SortingClassDiagram">
</div>
<div class="title">Figure 23. Overview of the class diagram representation of the coupon sorting implementation.</div>
</div>
<div class="paragraph">
<p>When a <code>sort</code> command is executed, the field to sort by is indicated by the
inputted prefix. The sequence diagram below describes what happens when a
<code>sort</code> command is run.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="../images/SortCommandSeqDiagram.png" alt="SortCommandSeqDiagram">
</div>
<div class="title">Figure 24. Sequence diagram describing the process of sorting coupons.</div>
</div>
<div class="paragraph">
<p>Depending on the prefix to sort by, <code>ModelManager#sortCoupons()</code> will be
called with the relevant comparator as its argument. The
<code>ModelManager#sortCoupons()</code> method subsequently calls the
<code>SortedList#setComparator()</code> method (not shown in the above diagram), which
leads to a change of the comparator of the <code>SortedList</code> stored in
<code>ModelManager</code> , thus triggering a sort of the <code>SortedList</code>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="design-considerations-3"><a class="link" href="#design-considerations-3">Design Considerations</a></h4>
<div class="sect4">
<h5 id="aspect-persistent-or-non-persistent-sort"><a class="link" href="#aspect-persistent-or-non-persistent-sort">Aspect: Persistent or non - persistent sort?</a></h5>
<div class="ulist">
<ul>
<li>
<p><strong>Alternative 1 (current choice):</strong> Make sorting non - persistent.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Sorting is faster as no write to disk is needed to make the new
order persistent. Additionally, with the coupons being sorted by the time they
are added to the coupon stash by default, there is no way to restore this order
without storing the time a coupon was added to the stash. Thus, the non -
persistent approach shines here as restoring the original order of the coupon
stash is as trivial as reopening the program.</p>
</li>
<li>
<p>Cons: If a user prefers a particular default sorting order for their
coupons, they have to retype the <code>sort</code> command each time the program is
launched or each time a coupon is added or edited.</p>
</li>
</ul>
</div>
</li>
<li>
<p><strong>Alternative 2:</strong> Make sorting persistent.</p>
<div class="ulist">
<ul>
<li>
<p>Pros: Gives users more freedom over the default order of their coupons.</p>
</li>
<li>
<p>Cons: Can be unnecessarily complicated to implement a hidden field stating
a coupon&#8217;s addition time just so users can revert to the default order.
Additionally, it can be confusing to users when there are so many different
ways to sort.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>In our usage during testing, we have never had the urge to have a default
sorting order when the program is launched. Plus, we feel that the simplicity
of excluding a sort by default order function will be well favored by users,
and thus we chose alternative 1.</p>
</div>
</div>
</div>
</div>
</div>
</div></div><div id="footer"><div class="container"><div id="footer-text">Last updated 2020-04-13 15:28:03 UTC</div></div></div></body></html>